<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.arjjs.ccm.modules.ccm.rest.dao.AlarmHandleInfoDao">

    <!--查询警情事件-->
    <select id="findAlarm" resultType="AlarmHandleInfo">
      SELECT
	    a2.area_point AS 'alarm_point',
	  COUNT(alarm.id) AS 'alarm_num'
	  FROM
	    sys_area a
	  LEFT JOIN bph_alarm_info alarm ON alarm.del_flag = '0' AND alarm.area_id=a.id
	  LEFT JOIN ccm_org_area a2 ON a2.area_id= a.id
	  WHERE
	    a.type =#{type}
	  GROUP BY
	    a.id
	  ORDER BY
	  COUNT(alarm.id) DESC
    </select>
</mapper>